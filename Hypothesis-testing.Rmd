---
title: "Teaching assistance: Poltical Data Analysis. Pontificia Universidad Católica de Chile, Political Science Department"
output: html_document
---

Sebastián Huneeus, PhD (C) in Political Science
lshuneeus@uc.cl


## Unit: Statistical inference
### Topic: Hypothesis testing for a population proportion

In this session, we will cover the five steps of hypothesis testing shown in chapter 9 of the book by Agresti & Franklin, “Statistics, The Art and Science of Learning from Data” (3rd edition). We will do a population proportion hypothesis test using Paraguay's sample values in the LAPOP Survey (2016). This load the data from the R package “Paqueteadp”.


```{r, message=FALSE}
library(tidyverse)
library(janitor)
library(paqueteadp)

lapop<-paqueteadp::lapop
```
 
### Research question
 
In Paraguay ¿Is the population proportion of those who justify shutting down the Congress equal to those who don't support closing the Congress? 

 
```{r}
lapop %>% filter(pais_nombre == "Paraguay") %>% tabyl(justifica_cierre_cong) %>% adorn_totals()

```



### Step 1: Checking the assumptions

We assume a random sample. The sample size is sufficiently large, of 544 observations. Thus we define that we can do hypothesis testing. 


### Step 2: Definig the null and alternative hypothesis

We define the null and alternative hypotheses. In this case, the null indicates that supporting to shut down congress equals the probability of not supporting to shut down congress.    

      HO: P1 = 0.5
      H1: P1 ≠ 0.5
      
The alternative hypothesis is two-tailed, thus, we want to find a sufficiently extreme Z statistic, regardless of its positive or negative value. 


### Step 3: Calculating the Z statistic


```{r}
lapop %>% filter(pais_nombre == "Paraguay")  %>% 
  tabyl(justifica_cierre_cong) %>% adorn_totals()

tibble(p_hat = 0.29, 
       null = 0.5, 
       n = 544, 
       numerator = p_hat - null, 
       denominator = sqrt(null*(1-null)/n), 
       z = numerator / denominator)
```


### Step 4: Finding the P value for the Z statistic 

The Z statistic is -9.79. We look for the two-tail probability of finding this value of Z under the null hypothesis. 


```{r}
tibble(p_hat = 0.29, 
       null = 0.5, 
       n = 544, 
       numerator = p_hat - null, 
       denominator = sqrt(null*(1-null)/n), 
       z = numerator / denominator, 
       p_value = 2*pnorm(-abs(z)))

```


### Step 5: Interpretation

We obtained a p-value smaller than 0.001; hence, we have strong evidence against the null hypothesis. With a confidence level of 99.9%, we can establish that the proportion of those in Paraguay who support shutting down the Congress differs from those who don't. 

